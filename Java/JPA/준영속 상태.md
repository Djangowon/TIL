# 준영속 상태

> 실제로 당장 이해하기는 쉽지 않음 -> 이런 게 있다~정도로 알고 넘어가면 될 듯  
> em.persist 해서 집어넣을 때도 영속 상태가 되지만, em.find 로 조회를 할 때도 영속성 컨텍스트에 없으면 영속 상태가 됨

<br>
<br>

## 준영속 상태?
- 영속 -> 준영속
- 영속 상태의 엔티티가 영속성 컨텍스트에서 분리(detached)되는 것
- 영속성 컨텍스트가 제공하는 기능을 사용하지 못 한다.
	- update나 더티체킹 등

<br>


### 준영속 상태로 만드는 방법
- em.detach(member);
	- 특정 엔티티만 준영속 상태로 전환
- em.clear()
	- 영속성 컨텍스트를 완전히 초기화 -> 영속성 컨텍스트를 통으로 날리기 때문에 1차 캐시도 없음
- em.close()
	- 영속성 컨텍스트를 종료
이렇게 준영속 상태로 분리를 하면 트랜잭션 커밋하는 시점에 아무일도 일어나지 않음
더 이상 JPA가 관리하는 대상이 아니기 때문에.

<br>

```
Member member = em.find(Member.class, 150L);
member.setName("준영속")

em.detach(member);

System.out.println("======");
tx.commit();
```

<br>

위의 코드를 실행하면 select 쿼리만 나가고 수정을 했음에도 update 쿼리가 나가지 않는 걸 확인할 수 있음
