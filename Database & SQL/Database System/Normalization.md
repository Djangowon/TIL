# Normalization
## 좋은 릴레이션과 나쁜 릴레이션
### 잘못된 데이터베이스 모델링
* 데이터의 중복
    * 일관성 유지의 어려움
    * 저장 공간 낭비
* 갱신 이상
    * 삽입 이상 - 레코드 추가 시 불필요한 컬럼의 값이 없이는 추가하지 못 하는 경우
    * 삭제 이상 - 삭제 시 의도하지 않았던 다른 데이터가 삭제되는 경우
    * 수정 이상 - 중복 저장된 레코드를 수정 시 모두 반영이 안되어 데이터베이스의 일관성이 깨지는 경우

### 좋은 릴레이션의 개념
* 컴퓨터 프로그래머적 관섬에서의 모델링
    > 어떻게 데이터를 저장해야 하는가?
* 릴레이션의 스키마가 얼마나 효율적으로 실세계를 반영하고 있는지 평가
* 고려사항
    * 한 릴레이션 내의 컬럼 간의 관계 분석
    * 원하지 않는 데이터의 종속과 중복 제거
    * 새로운 컬럼들이 데이터베이스에 추가될 때, 기존 컬럼과의 관계 수정을 최소화

## 함수적 종속성
### 함수적 종속성의 정의
* 릴레이션 인스턴스를 분석하여 속성들 간의 연관관계를 표현한 것
* 릴레이션의 효율성을 향상시켜 좋은 릴레이션으로 변환하는데 이용되는 중요한 개념
    > 임의의 릴레이션 스키마 R의 인스턴스 r(R)에 포함되는 서로 다른 두 레코드 r₁,r₂와 컬럼 집합 X와 Y에 대해, r₁[X] = r₂[X] 일 때, r₁[Y] = r₂[Y] 이면 함수적 종속성 X 🡒 Y가 성립한다.

### 함수적 종속성의 확장
* 함수적 종속성은 릴레이션의 효율성 여부에 중요한 판단기준
* 그러나 릴레이션의 인스턴스만으로 내재된 모든 함수적 종속성을 찾아내기 어려움
* 판별되지 않은 모든 함수적 종속성을 찾기 위해 추론 규칙을 사용하여 함수적 종속성을 확장
* 클로저(closure)
    * 판별된 함수적 종속성 집합으로부터 유추할 수 있는 모든 함수적 종속성 집합 🡒 F⁺

### 함수적 종속성 추론 규칙
* 암스트롱 공리(Armstrong's axiom)
```
1. 재귀성 규칙: X⊇Y 이면, X🡒Y 이다.
2. 부가성 규칙: X🡒Y 이면, XZ🡒YZ 이다.
3. 이행성 규칙: X🡒Y 이고, Y🡒Z 이면, X🡒Z 이다.
4. 분해 규칙: X🡒YZ 이면, X🡒Y 이다.
5. 합집합 규칙: X🡒Y 이고, X🡒Z 이면, X🡒YZ 이다.
6. 의사 이행성 규칙: X🡒Y 이고, WY🡒Z 이면, WX🡒Z 이다.
```

### 카노니컬 커버
* 함수적 종속성 추론 규칙으로 확장된 클로저에는 `자명한 종속성`과 `중복된 종속성`을 포함
    * ex) 자명한 종속성: A🡒A 의미가 당연한 종속성, 중복된 종속성: X🡒AB, X🡒B 의미가 여러번 존재
* 불필요한 함수적 종속성을 제거한 표준형으로 변환 후 정규화를 수행
* 표준형 조건
    * F의 모든 함수적 종속성의 오른편 속성은 반드시 1개
    * F에서 X🡒A를 X의 진부분집합 Y에 대하여 Y🡒A로 교체했을 때, 그 집합이 F와 동등한 집합이 불가능
    * F에서 어떤 함수적 종속성을 제거했을 때, 그 집합이 F와 동등한 집합이 불가능

## 정규화
### 정규형
* 이상 현상을 최소화 하도록 특정 조건을 갖춘 릴레이션의 형식
* 정규형의 분류
    > 제1정규형
    > > 제2정규형
    > > > 제3정규형
    > > > > BC정규형
    > > > > > 제4정규형
    > > > > > > 제5정규형

### 정규화의 목적
* 특정 정규형의 조건을 만족하도록 릴레이션과 속성을 재구성하는 과정

* 정규화의 기능
    * 데이터베이스 내에 모든 릴레이션을 효과적으로 표현
    * 보다 간단한 관계 연산에 기초하여 검색 알고리즘을 효과적으로 작성할 수 있도록 지원
    * 바람직하지 않은 삽입, 수정, 삭제 등의 이상 발생 방지
    * 새로운 형태의 데이터가 삽입될 때 릴레이션 재구성의 필요성을 축소

### 제1정규형
> 릴레이션 스키마에서 정의된 모든 속성의 도메인이 원자값을 갖는 상태

* 가장 조건이 단순한 정규형
* 관계형 모델에 조건에 따라 자동 적용되는 정규형

#### 함수적 종속성 다이어그램(FDD)
* 릴레이션 내의 속성간의 종속 관계를 직관적이고 이해하기 쉽게 도식화 한 표현 방식
    * 직사각형: 속성 또는 속성 집합
    * 화살표: 함수적 종속성

### 제2정규형
> 주어진 릴레이션의 인스턴스가 기본키가 아닌 속성들이 기본키에 완전히 종속되어 있는 상태

* 릴레이션이 제1정규형을 만족하고 기본키의 부분집합이 특정 속성을 종속하고 있지 않은 상태

#### 릴레이션의 무손실 분해(lossless decomposition)
> 스키마 R에 함수적 종속성 X🡒Y가 존재하고 X∩Y=∅이면, R을 R-Y와 XY로 분해

### 제3정규형
> 릴레이션이 제2정규형을 만족하고, 기본키가 아닌 속성들이 어떤 키에도 이행적으로 종속되지 않은 상태

### BC정규형
> 릴레이션이 제3정규형을 만족하고 릴레이션에 성립하는 X🡒Y 형태의 모든 함수적 종속성에 대하여 X가 수퍼키인 상태

### 역정규화의 개념
* 정규화
    * 릴레이션 분할을 통해 데이터의 중복성을 최소화 하는 과정
    * 사용 과정에서 많은 조인연산을 유발
* 역정규화
    * 정규화의 반대 과정
    * 정규화를 통해 분리되었던 릴레이션을 통합하는 재조정을 수행하고 정보의 부분적 중복을 허용하는 기법
    * 데이터 접근 성능을 개선 목적
* 정규화되지 않은 스키마와 역정규화 스키마는 구별

## 정리
* 데이터베이스 모델링 과정에서 효율성을 위해 어떤 속성들을 그룹화하여 테이블로 작성할 것인지 고려할 필요가 있으며 전체적인 테이블 구조는 데이터베이스의 정확성을 판단하는 데 중요한 기준이 된다.
* 정규화는 데이터의 중복을 제거하고, 새로운 속성들이 데이터베이스에 추가될 때 기존 속성과의 관계에서 수정을 최소화해야 한다는 것이 목적이다. 따라서 정규화 과정을 통해 데이터 저장을 위한 공간의 낭비를 최소화 할 수 있다.
* 정규화 이전에 데이터베이스 조작에서 발생하는 삽입, 삭제, 수정 등의 갱신 이상 현상을 정규화를 통해 방지할 수 있다.
* 속성들 간의 연관관계를 표현 한함수적 종속성은 릴레이션의 효율성 여부에 중요한 판단기준이 되지만 릴레이션의 인스턴스만으로 잠재된 모든 함수적 종속성을 찾아내기 어렵기 때문에 이를 확장하기 위해 암스트롱 공리를 적용하여 클로저로 확장한다.
* 도출된 클로저에는 자명한 함수적 종속성이나 중복된 함수적 종속성을 포함하고 있으므로 이러한 불필요한 종속성을 제거한 카노니컬 커버를 사용하여 정규화를 진행한다.
* 함수적 종속성은 릴레이션 스키마의 속성들 사이에 명시되는 기본적인 제약조건이다. 함수적 종속성에 의한 방법과 추론하는 방법을 바탕으로 기본적인 정규형을 구성할 수 있다.
* 정규형의 만족시켜야 하는 제약조건에 따라 제1정규형, 제2정규형, 제3정규형, BC정규형, 제4정규형, 제5정규형 순서로 진행된다. 정규형의 조건은 정규화가 진행될수록 강화된다.
